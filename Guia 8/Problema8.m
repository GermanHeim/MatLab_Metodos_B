% Ej 7
% German Heim
close all
clear all
format long
clc

A=[1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; ...
    2^3 2^2 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; ...
    0 0 0 0 2^3 2^2 2 1 0 0 0 0 0 0 0 0 0 0 0 0; ...
    0 0 0 0 3^3 3^2 3 1 0 0 0 0 0 0 0 0 0 0 0 0; ...
    0 0 0 0 0 0 0 0 3^3 3^2 3 1 0 0 0 0 0 0 0 0; ...
    0 0 0 0 0 0 0 0 5^3 5^2 5 1 0 0 0 0 0 0 0 0; ...
    0 0 0 0 0 0 0 0 0 0 0 0 5^3 5^2 5 1 0 0 0 0; ...
    0 0 0 0 0 0 0 0 0 0 0 0 7^3 7^2 7 1 0 0 0 0; ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7^3 7^2 7 1; ...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8^3 8^2 8 1;...
    3*2^2 2*2 1 0 -3*2^2 -2*2 -1 0 0 0 0 0 0 0 0 0 0 0 0 0;...
    0 0 0 0 3*3^2 2*3 1 0 -3*3^2 -2*3 -1 0 0 0 0 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 3*5^2 2*5 1 0 -3*5^2 -2*5 -1 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 0 0 0 0 3*7^2 2*7 1 0 -3*7^2 -2*7 -1 0;...
    6 2 0 0 -6 -2 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
    0 0 0 0 6*2 2 0 0 -6*2 -2 0 0 0 0 0 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 6*3 2 0 0 -6*3 2 0 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 0 0 0 0 6*5 2 0 0 -6*5 -2 0 0;...
    6 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6*8 2 0 0];

B=transpose([3 6 6 19 19 99 99 291 291 444 0 0 0 0 0 0 0 0 0 0]);

coef=linsolve(A, B);

valores_x=[1 2 3 5 7 8];
valores_y=[3 6 19 99 291 444];

hold on
grid on
scatter(valores_x, valores_y)

x=linspace(1, 8, 1000);
for i=1:length(x)
    if x(i)<2 && x(i)>1
        val_y(i)=coef(1)*x(i)^3 + coef(2)*x(i)^2 + coef(3)*x(i) + coef(4);
    elseif x(i)<=3 && x(i)>2
        val_y(i)=coef(5)*x(i)^3 + coef(6)*x(i)^2 + coef(7)*x(i) + coef(8);
    elseif x(i)<=5 && x(i)>3
        val_y(i)=coef(9)*x(i)^3 + coef(10)*x(i)^2 + coef(11)*x(i) + coef(12);
    elseif x(i)<=7 && x(i)>5
        val_y(i)=coef(13)*x(i)^3 + coef(14)*x(i)^2 + coef(15)*x(i) + coef(16);
    elseif x(i)<=8 && x(i)>7
        val_y(i)=coef(17)*x(i)^3 + coef(18)*x(i)^2 + coef(19)*x(i) + coef(20);
    end
end

plot(x, val_y)
spline_matlab = interp1(valores_x, valores_y,x, 'spline');
plot(x, spline_matlab)
legend('Datos', 'Spline cubico','Spline cubico Matlab')

disp(['Prediccion para x=4, y=', num2str(coef(9)*4^3 + coef(10)*4^2 + coef(11)*4 + coef(12))])
disp(['Prediccion para x=2.5, y=', num2str(coef(5)*2.5^3 + coef(6)*2.5^2 + coef(7)*2.5 + coef(8))])